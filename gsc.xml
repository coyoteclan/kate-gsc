<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE language>
<language name="CoD GSC" version="1.0" kateversion="5.79" section="Scripts"
          extensions="*.gsc" mimetype="text/x-gsc" priority="15"
          author="Generated by ChatGPT" license="MIT">
  <highlighting>
    <!-- === Keyword Lists === -->
    <list name="controlflow">
      <item>if</item>
      <item>else</item>
      <item>while</item>
      <item>for</item>
      <item>break</item>
      <item>return</item>
      <item>switch</item>
      <item>case</item>
      <item>default</item>
    </list>

    <list name="gsc_keywords">
      <item>thread</item>
      <item>wait</item>
      <item>waittill</item>
      <item>waittillframeend</item>
      <item>end</item>
      <item>endon</item>
      <item>level</item>
      <item>self</item>
    </list>

    <list name="types">
      <item>int</item>
      <item>float</item>
      <item>string</item>
      <item>bool</item>
    </list>

    <list name="constants">
      <item>true</item>
      <item>false</item>
      <item>undefined</item>
    </list>

    <!-- === Contexts === -->
    <contexts>
      <context name="Normal" attribute="Normal Text" lineEndContext="#stay">
        <DetectSpaces />
        
        <!-- Symbols and operators -->
        <AnyChar attribute="Symbol" context="#stay" String="{}()[]=!&lt;&gt;:+\-*/|&amp;^%;,." />

        <!-- Keywords -->
        <IncludeRules context="MatchKeywords" />
        
        <!-- Strings -->
        <DetectChar attribute="String" context="StringDQ" char="&quot;" />
        <DetectChar attribute="String" context="StringSQ" char="'" />

        <!-- Numbers (integer & simple float) -->
        <RegExpr attribute="Number" context="#pop" String="\b[0-9]+(\.[0-9]+)?\b" />

        <!-- Comments -->
        <StringDetect attribute="Comment" context="LineComment" String="//" />
        <Detect2Chars attribute="Comment" context="BlockComment" char="/" char1="*" />

        <!-- Preprocessors -->
        <DetectChar attribute="Preprocessor" context="Preprocessor" char="#" />
        
        <!-- Identifiers (fallback) -->
        <DetectIdentifier />
      </context>

      <context name="Preprocessor" attribute="Preprocessor" lineEndContext="#pop">
        <RegExpr attribute="Preprocessor" context="#pop" String="^\s*#.*$" />
      </context>

      <context name="MatchKeywords" attribute="Normal Text" lineEndContext="#pop">
        <keyword attribute="Control Flow" context="#stay" String="controlflow" />
        <keyword attribute="Keyword" context="#stay" String="gsc_keywords" />
        <keyword attribute="Data Type" context="#stay" String="types" />
        <keyword attribute="Keyword" context="#stay" String="constants" />
        <!--                   ^ Keyword looks better than Constant imo -->
      </context>

      <context name="LineComment" attribute="Comment" lineEndContext="#pop">
        <AnyChar attribute="Comment" context="#stay" String=".*" />
      </context>

      <context name="BlockComment" attribute="Comment" lineEndContext="#pop" fallthroughContext="#stay">
        <Detect2Chars attribute="Comment" context="#pop" char="*" char1="/" />
        <AnyChar attribute="Comment" context="#stay" String="." />
      </context>

      <context name="StringDQ" attribute="String" lineEndContext="#pop" fallthroughContext="#stay">
        <Detect2Chars attribute="String Escape" context="#stay" char="\" char1="n" />
        <DetectChar attribute="String" context="#pop" char="&quot;" />
        <AnyChar attribute="String" context="#stay" String="[^&quot;]" />
      </context>

      <context name="StringSQ" attribute="String" lineEndContext="#pop" fallthroughContext="#stay">
        <Detect2Chars attribute="String Escape" context="#stay" char="\" char1="n" />
        <DetectChar attribute="String" context="#pop" char="'" />
        <AnyChar attribute="String" context="#stay" String="[^']" />
      </context>
    </contexts>

    <!-- === Style Definitions === -->
    <itemDatas>
      <itemData name="Preprocessor"    defStyleNum="dsPreprocessor"  spellChecking="false"/>
      <itemData name="Normal Text"     defStyleNum="dsNormal"        spellChecking="false"/>
      <itemData name="Control Flow"    defStyleNum="dsControlFlow"   spellChecking="false"/>
      <itemData name="Keyword"         defStyleNum="dsKeyword"       spellChecking="false"/>
      <itemData name="Data Type"       defStyleNum="dsDataType"      spellChecking="false"/>
      <itemData name="Constant"        defStyleNum="dsConstant"      spellChecking="false"/>
      <itemData name="Number"          defStyleNum="dsDecVal"        spellChecking="false"/>
      <itemData name="String"          defStyleNum="dsString"        spellChecking="false"/>
      <itemData name="String Escape"   defStyleNum="dsSpecialChar"   spellChecking="false"/>
      <itemData name="Comment"         defStyleNum="dsComment"       spellChecking="false"/>
      <itemData name="Symbol"          defStyleNum="dsOperator"      spellChecking="false"/>
      <itemData name="Error"           defStyleNum="dsError"         spellChecking="false"/>
    </itemDatas>
  </highlighting>

  <general>
    <comments>
      <comment name="singleLine" start="//" />
      <comment name="multiLine"  start="/*" end="*/" />
    </comments>
    <keywords casesensitive="0" additionalDeliminator="#'&quot;" />
    <folding>
      <beginRegion regexp="\b(if|else|while|for|thread|function)\b.*\{" />
      <endRegion   regexp="\}" />
    </folding>
  </general>
</language>
